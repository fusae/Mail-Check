# ğŸš€ æœåŠ¡å™¨éƒ¨ç½²è¯´æ˜

## ğŸ“ æ–°å¢æ–‡ä»¶

æœ¬ç›®å½•ä¸‹æ–°å¢äº†ä»¥ä¸‹éƒ¨ç½²ç›¸å…³æ–‡ä»¶ï¼š

### æ ¸å¿ƒè„šæœ¬
- **`deploy.sh`** - å®Œæ•´çš„ä¸€é”®éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
- **`quick_deploy.sh`** - å¿«é€Ÿéƒ¨ç½²è„šæœ¬ï¼ˆé€‚ç”¨äºé…ç½®å®Œæˆåçš„å¿«é€Ÿå®‰è£…ï¼‰
- **`run.sh`** - å¯åŠ¨è„šæœ¬ï¼ˆå·²å‡çº§ï¼Œæ”¯æŒåå°è¿è¡Œï¼‰
- **`stop.sh`** - åœæ­¢è„šæœ¬ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
- **`status.sh`** - çŠ¶æ€æŸ¥çœ‹è„šæœ¬ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰

### æ–‡æ¡£
- **`éƒ¨ç½²æŒ‡å—.md`** - è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£
- **`å¿«é€Ÿéƒ¨ç½².md`** - æœ¬æ–‡ä»¶ï¼Œå¿«é€Ÿä¸Šæ‰‹æŒ‡å—

## ğŸ¯ ä¸¤ç§éƒ¨ç½²æ–¹å¼

### æ–¹å¼ä¸€ï¼šå®Œæ•´éƒ¨ç½²ï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šé¦–æ¬¡åœ¨æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œæˆ–éœ€è¦å®‰è£…ç³»ç»Ÿä¾èµ–

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
rsync -avz --exclude 'venv' \
  --exclude '__pycache__' \
  --exclude '*.pyc' \
  --exclude 'logs' \
  --exclude 'data' \
  ./ user@server:/path/to/Mail_Check/

# 2. è¿æ¥åˆ°æœåŠ¡å™¨
ssh user@server
cd /path/to/Mail_Check

# 3. ç¼–è¾‘é…ç½®æ–‡ä»¶
vim config/config.yaml

# 4. æ‰§è¡Œä¸€é”®éƒ¨ç½²
chmod +x deploy.sh
./deploy.sh

# 5. å¯åŠ¨æœåŠ¡
./run.sh --daemon
```

### æ–¹å¼äºŒï¼šå¿«é€Ÿéƒ¨ç½²

**é€‚ç”¨åœºæ™¯**ï¼šæœåŠ¡å™¨å·²ç»é…ç½®å¥½ï¼Œåªéœ€è¦å¿«é€Ÿå®‰è£…Pythonä¾èµ–

```bash
# 1. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨
rsync -avz --exclude 'venv' \
  --exclude '__pycache__' \
  ./ user@server:/path/to/Mail_Check/

# 2. è¿æ¥åˆ°æœåŠ¡å™¨
ssh user@server
cd /path/to/Mail_Check

# 3. ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆå¦‚æœè¿˜æ²¡æœ‰é…ç½®ï¼‰
vim config/config.yaml

# 4. å¿«é€Ÿéƒ¨ç½²
chmod +x quick_deploy.sh
./quick_deploy.sh

# 5. å¯åŠ¨æœåŠ¡
./run.sh --daemon
```

## ğŸ“‹ é…ç½®æ–‡ä»¶æ£€æŸ¥æ¸…å•

åœ¨éƒ¨ç½²å‰ï¼Œç¡®ä¿ `config/config.yaml` ä¸­å·²é…ç½®ä»¥ä¸‹ä¿¡æ¯ï¼š

```yaml
# é‚®ç®±é…ç½®
email:
  imap_server: "imap.qq.com"      # æˆ– imap.163.com, imap.gmail.com
  email_address: "your@email.com"
  app_password: "your_app_password"

# AIé…ç½®
ai:
  api_key: "your_zhipu_api_key"

# é€šçŸ¥é…ç½®ï¼ˆé€‰ä¸€ä¸ªï¼‰
notification:
  provider: "wechat_work"  # æˆ– "telegram"
  wechat_work:
    webhook_url: "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=YOUR_WEBHOOK_KEY"
  telegram:
    bot_token: "your_bot_token"
    chat_id: "your_chat_id"
```

## ğŸ® éƒ¨ç½²åç®¡ç†

### åŸºæœ¬å‘½ä»¤
```bash
# å¯åŠ¨æœåŠ¡ï¼ˆåå°è¿è¡Œï¼‰
./start_all.sh

# åœæ­¢æœåŠ¡
./stop.sh

# æŸ¥çœ‹çŠ¶æ€
./status.sh

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/sentiment_monitor.log
tail -f logs/api_server.log
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/sentiment_monitor.log

# æŸ¥çœ‹æœ€å100è¡Œ
tail -100 logs/sentiment_monitor.log

# æœç´¢é”™è¯¯
grep "ERROR" logs/sentiment_monitor.log

# æœç´¢è´Ÿé¢èˆ†æƒ…
grep "å‘ç°è´Ÿé¢èˆ†æƒ…" logs/sentiment_monitor.log
```

### æ•°æ®åº“æŸ¥è¯¢
```bash
# æŸ¥çœ‹å·²å¤„ç†çš„é‚®ä»¶
sqlite3 data/processed_emails.db \
  "SELECT * FROM processed_emails ORDER BY processed_at DESC LIMIT 10;"

# æŸ¥çœ‹è´Ÿé¢èˆ†æƒ…è®°å½•
sqlite3 data/processed_emails.db \
  "SELECT * FROM negative_sentiments ORDER BY processed_at DESC;"
```

## ğŸ–¥ï¸ Web ä»ªè¡¨ç›˜ï¼ˆå¯é€‰ï¼‰

```bash
cd web
npm install
npm run build
```

å°† `web/dist` é€šè¿‡ Nginx é™æ€ç«™ç‚¹æ–¹å¼å¯¹å¤–æä¾›ï¼Œå¹¶åä»£ `/api` ä¸ `/feedback` åˆ°é…ç½®çš„ API ç«¯å£ã€‚

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: éƒ¨ç½²è„šæœ¬æ— æ³•æ‰§è¡Œ
```bash
chmod +x deploy.sh run.sh stop.sh status.sh quick_deploy.sh
```

### Q2: é…ç½®æ–‡ä»¶ä¸å­˜åœ¨
```bash
# æ£€æŸ¥é…ç½®æ–‡ä»¶
ls -la config/config.yaml

# å¦‚æœä¸å­˜åœ¨ï¼Œéœ€è¦åˆ›å»º
vim config/config.yaml
```

### Q3: å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—
cat logs/startup.log

# æˆ–å‰å°è¿è¡ŒæŸ¥çœ‹è¯¦ç»†é”™è¯¯
./run.sh
```

### Q4: è¿›ç¨‹å·²åœ¨è¿è¡Œ
```bash
# æŸ¥çœ‹è¿›ç¨‹
ps aux | grep main.py

# åœæ­¢è¿›ç¨‹
./stop.sh

# é‡æ–°å¯åŠ¨
./run.sh --daemon
```

## ğŸ“Š ç›‘æ§å»ºè®®

### å®šæœŸæ£€æŸ¥çŠ¶æ€
```bash
# è®¾ç½®å®šæ—¶æ£€æŸ¥ï¼ˆæ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œ
0 * * * * cd /path/to/Mail_Check && ./status.sh >> logs/status.log 2>&1
```

### æ•°æ®åº“å¤‡ä»½
```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > backup.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/path/to/backups"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
cp data/processed_emails.db $BACKUP_DIR/processed_emails_$DATE.db

# ä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "processed_emails_*.db" -mtime +7 -delete

echo "æ•°æ®åº“å¤‡ä»½å®Œæˆ: $BACKUP_DIR/processed_emails_$DATE.db"
EOF

chmod +x backup.sh

# æ·»åŠ åˆ°crontabï¼Œæ¯å¤©å¤‡ä»½ä¸€æ¬¡
crontab -e
# æ·»åŠ : 0 4 * * * /path/to/Mail_Check/backup.sh
```

## ğŸ‰ éƒ¨ç½²æˆåŠŸæ ‡å¿—

å½“ä½ çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºæ—¶ï¼Œè¯´æ˜éƒ¨ç½²æˆåŠŸï¼š

```
==================================
[SUCCESS] éƒ¨ç½²å®Œæˆï¼
==================================

å¸¸ç”¨å‘½ä»¤:
  å¯åŠ¨æœåŠ¡: ./run.sh
  åœæ­¢æœåŠ¡: ./stop.sh
  æŸ¥çœ‹çŠ¶æ€: ./status.sh
  æŸ¥çœ‹æ—¥å¿—: tail -f logs/sentiment_monitor.log

ä¸‹ä¸€æ­¥æ“ä½œ:
  1. æ£€æŸ¥é…ç½®æ–‡ä»¶: config/config.yaml
  2. ç¡®ä¿é…ç½®æ–‡ä»¶ä¸­çš„é‚®ç®±ã€AIå¯†é’¥ç­‰ä¿¡æ¯æ­£ç¡®
  3. è¿è¡Œæµ‹è¯•: ./status.sh
  4. å¯åŠ¨æœåŠ¡: ./run.sh

==================================
```

å¯åŠ¨æœåŠ¡åï¼Œä½¿ç”¨ `./status.sh` æŸ¥çœ‹è¿è¡ŒçŠ¶æ€ï¼š

```
èˆ†æƒ…ç›‘æ§ç³»ç»ŸçŠ¶æ€
==================================================================
è¿›ç¨‹çŠ¶æ€: è¿è¡Œä¸­
è¿›ç¨‹ID: 12345
è¿è¡Œæ—¶é—´: 02:15:30
å†…å­˜ä½¿ç”¨: 125.5MB

æ—¥å¿—æ–‡ä»¶: logs/sentiment_monitor.log
æ—¥å¿—å¤§å°: 2.3M

æœ€è¿‘5æ¡æ—¥å¿—:
2026-01-19 10:30:05 - email_monitor - INFO - æˆåŠŸè¿æ¥åˆ°Gmail: your@gmail.com
2026-01-19 10:30:06 - email_monitor - INFO - æ‰¾åˆ° 0 å°æ–°é‚®ä»¶
2026-01-19 10:30:06 - email_monitor - INFO - å·²æ–­å¼€Gmailè¿æ¥
2026-01-19 10:30:06 - __main__ - INFO - ç­‰å¾… 300 ç§’åç»§ç»­...

==================================================================
æ•°æ®åº“: å­˜åœ¨ (å¤§å°: 1.2M)
```

## ğŸ“ è·å–å¸®åŠ©

å¦‚é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ `éƒ¨ç½²æŒ‡å—.md` - è¯¦ç»†çš„éƒ¨ç½²æ–‡æ¡£
2. æŸ¥çœ‹ `logs/sentiment_monitor.log` - ç³»ç»Ÿè¿è¡Œæ—¥å¿—
3. è¿è¡Œ `./status.sh` - æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
4. æ£€æŸ¥ `config/config.yaml` - é…ç½®æ–‡ä»¶

---

**ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼ğŸš€**
